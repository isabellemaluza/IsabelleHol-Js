theory Calculadora_Arvore
  imports Main
begin

(* Definindo a estrutura da árvore de expressão *)
datatype expr =
    Num real                  (* Nó folha: número *)
  | Soma expr expr            (* Nó: soma de duas expressões *)
  | Subtracao expr expr       (* Nó: subtração de duas expressões *)
  | Multiplicacao expr expr   (* Nó: multiplicação de duas expressões *)
  | Divisao expr expr         (* Nó: divisão de duas expressões *)

(* Função para avaliar a árvore *)
fun avaliar :: "expr \<Rightarrow> real" where
  "avaliar (Num x) = x" |
  "avaliar (Soma e1 e2) = (avaliar e1) + (avaliar e2)" |
  "avaliar (Subtracao e1 e2) = (avaliar e1) - (avaliar e2)" |
  "avaliar (Multiplicacao e1 e2) = (avaliar e1) * (avaliar e2)" |
  "avaliar (Divisao e1 e2) = (if avaliar e2 \<noteq> 0 then (avaliar e1) / (avaliar e2) else 0)" 

(* Exemplos de uso *)
value "avaliar (Soma (Num 3) (Num 5))" 
(* Resultado: 8 *)

value "avaliar (Multiplicacao (Soma (Num 2) (Num 3)) (Num 4))"
(* Resultado: (2+3)*4 = 20 *)

value "avaliar (Divisao (Num 10) (Num 2))"
(* Resultado: 5 *)

value "avaliar (Subtracao (Num 7) (Multiplicacao (Num 2) (Num 3)))"
(* Resultado: 7 - (2*3) = 1 *)

end
